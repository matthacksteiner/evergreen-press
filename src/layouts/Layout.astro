---
import '../styles/global.css';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import MetaKnight from '../components/MetaKnight.astro';

const { data, global, pageTitle } = Astro.props;
const colorPrimary = global.colorPrimary;
const colorSecondary = global.colorSecondary;
const colorTertiary = global.colorTertiary;
const colorBlack = global.colorBlack;
const colorWhite = global.colorWhite;
const colorTransparent = global.colorTransparent;
const colorBackground = global.colorBackground;

function getFonts() {
	return `
      ${global.font
				.map((item) => {
					return `@font-face {
		font-family: ${item.name};
		src: 	url(${item.url2}) format('woff2'),
				url(${item.url1}) format('woff');
		font-weight: normal;
		font-style: normal;
		font-display: swap;
		}`;
				})
				.join('\n')}
  `;
}

const fonts = getFonts();
---

<!DOCTYPE html>
<html lang="de" class={`bg--${colorBackground} full motion-safe:scroll-smooth`}>
	<head>
		<MetaKnight data={data} />
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width" />
		<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
		<meta name="generator" content={Astro.generator} />
		<title>{pageTitle}</title>
		<!-- <link rel="icon" href="/favicon.ico" /> -->
		<link rel="icon" href="/favicon.svg" type="image/svg+xml" />
		<!-- <link rel="apple-touch-icon" href="/apple-touch-icon.png" /> -->
		<!-- <link rel="manifest" href="/site.webmanifest" /> -->
		<meta name="theme-color" content={`${colorPrimary}`} />
	</head>
	<body
		class="mx-auto items-center overflow-x-hidden selection:bg-secondary selection:text-white"
		data-font={fonts}
	>
		<Header data={data} global={global} />

		<main class="mb-20 flex min-h-[100vh] w-full flex-col">
			<slot />
		</main>
		<Footer data={data} global={global} />
		<script>
			import '../scripts/menu.js';

			const fonts = document.body.dataset.font;
			const styles = document.createElement('style');
			styles.innerHTML = fonts;
			document.head.appendChild(styles);
		</script>
		<style
			is:global
			lang="css"
			define:vars={{
				global,
				colorPrimary,
				colorSecondary,
				colorTertiary,
				colorBlack,
				colorWhite,
				colorTransparent,
			}}
		>
			:root {
				--color-primary: var(--colorPrimary);
				--color-secondary: var(--colorSecondary);
				--color-tertiary: var(--colorTertiary);
				--color-black: var(--colorBlack);
				--color-white: var(--colorWhite);
				--color-transparent: var(--colorTransparent);
			}

			html {
				font-family: 'ValueSansPro-Regular';
			}
		</style>
	</body>
</html>
