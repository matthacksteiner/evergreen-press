---
import { getGlobal, getPage, getAllPages, type PageData } from '@lib/api';
import BaseLayout from '@layouts/BaseLayout.astro';
import Layouts from '@components/Layouts.astro';

export async function getStaticPaths() {
	const pages = await getAllPages();
	return pages.map((item) => {
		return {
			params: {
				slug: item.uri,
			},
		};
	});
}
const { slug } = Astro.params;
const global = await getGlobal();
const data = await getPage(slug as string);
const pageTitle = data.title;
---

<BaseLayout pageTitle={pageTitle} data={data} global={global}>
	<Layouts layouts={data.layouts} data={data} global={global} />
</BaseLayout>
